(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[799],{9375:function(e,t,r){Promise.resolve().then(r.bind(r,8281))},8281:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return m}});var a=r(7437),n=r(2265),s=r(16),l=r(2533),i=r(1304),o=r(6126),d=r(5557),c=r(3340),u=r(1219);function f(){let{currentSite:e}=(0,c.a)(),t=(null==e?void 0:e.id)||"",{data:r=[]}=(0,s.a)({queryKey:["/api/inventory/balances?siteId=".concat(t)],enabled:!!t}),{data:f=[]}=(0,s.a)({queryKey:["/api/inventory/items"]}),{data:m=[]}=(0,s.a)({queryKey:["/api/inventory/locations?siteId=".concat(t)],enabled:!!t}),[x,p]=(0,n.useState)("base"),[h,b]=(0,n.useState)(""),[y,w]=(0,n.useState)(""),j=(0,n.useMemo)(()=>new Map(f.map(e=>[e.id,e])),[f]),g=(0,n.useMemo)(()=>new Map(m.map(e=>[e.id,e])),[m]),v=(0,n.useMemo)(()=>{let e=new Set;return f.forEach(t=>t.allowedUoms.forEach(t=>e.add(t.uom))),["base",...Array.from(e)]},[f]),N=e=>{let t=j.get(e.itemId);if(!t||"base"===x)return"".concat(e.qtyBase);let r=t.allowedUoms.find(e=>e.uom===x);if(!r)return"".concat(e.qtyBase);let a=e.qtyBase/r.toBase;return"".concat(a.toFixed(2)," ").concat(x)},C=r.filter(e=>{let t=j.get(e.itemId),r=g.get(e.locationId),a=!t||"".concat(t.sku," ").concat(t.name).toLowerCase().includes(h.toLowerCase()),n=!r||r.label.toLowerCase().includes(y.toLowerCase());return a&&n});return(0,a.jsxs)("div",{className:"flex h-full flex-col",children:[(0,a.jsx)(l.L,{}),(0,a.jsxs)("div",{className:"flex flex-1 flex-col gap-6 p-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold tracking-tight",children:"Balances"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Current on-hand quantities in base units."})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsxs)(i.Ol,{children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,a.jsx)(i.ll,{className:"text-sm font-medium",children:"On-hand Balances"}),(0,a.jsxs)(o.Ph,{value:x,onValueChange:p,children:[(0,a.jsx)(o.i4,{className:"w-[180px]",children:(0,a.jsx)(o.ki,{placeholder:"Display UoM"})}),(0,a.jsx)(o.Bw,{children:v.map(e=>(0,a.jsx)(o.Ql,{value:e,children:"base"===e?"Base":e},e))})]})]}),(0,a.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2",children:[(0,a.jsx)(u.I,{placeholder:"Filter by item",value:h,onChange:e=>b(e.target.value),className:"w-full sm:w-[220px]"}),(0,a.jsx)(u.I,{placeholder:"Filter by location",value:y,onChange:e=>w(e.target.value),className:"w-full sm:w-[220px]"})]})]}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"rounded-md border",children:(0,a.jsxs)(d.iA,{children:[(0,a.jsx)(d.xD,{children:(0,a.jsxs)(d.SC,{children:[(0,a.jsx)(d.ss,{children:"Item"}),(0,a.jsx)(d.ss,{children:"Location"}),(0,a.jsx)(d.ss,{children:"Qty (Base)"})]})}),(0,a.jsx)(d.RM,{children:C.map(e=>{let t=j.get(e.itemId),r=g.get(e.locationId);return(0,a.jsxs)(d.SC,{children:[(0,a.jsx)(d.pj,{className:"font-medium",children:t?"".concat(t.sku," - ").concat(t.name):e.itemId}),(0,a.jsx)(d.pj,{children:(null==r?void 0:r.label)||e.locationId}),(0,a.jsx)(d.pj,{children:N(e)})]},e.id)})})]})})})]})]})]})}function m(){return(0,a.jsx)(f,{})}},2533:function(e,t,r){"use strict";r.d(t,{L:function(){return o}});var a=r(7437),n=r(7648),s=r(9376),l=r(1216);let i=[{label:"Dashboard",href:"/modules/inventory"},{label:"Items",href:"/modules/inventory/items"},{label:"Locations",href:"/modules/inventory/locations"},{label:"Balances",href:"/modules/inventory/balances"},{label:"Events",href:"/modules/inventory/events"},{label:"Reason Codes",href:"/modules/inventory/reason-codes"}];function o(){let e=(0,s.usePathname)();return(0,a.jsx)("div",{className:"flex flex-wrap gap-2 border-b px-6 pt-4",children:i.map(t=>{let r=e===t.href;return(0,a.jsx)(n.default,{href:t.href,className:(0,l.cn)("inline-flex items-center rounded-md px-3 py-2 text-sm font-medium",r?"bg-accent text-accent-foreground":"text-muted-foreground hover:text-foreground"),children:t.label},t.href)})})}},1304:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return l},aY:function(){return c},ll:function(){return o}});var a=r(7437),n=r(2265),s=r(1216);let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm",r),...n})});l.displayName="Card";let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",r),...n})});i.displayName="CardHeader";let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",r),...n})});o.displayName="CardTitle";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",r),...n})});d.displayName="CardDescription";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",r),...n})});c.displayName="CardContent",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",r),...n})}).displayName="CardFooter"},1219:function(e,t,r){"use strict";r.d(t,{I:function(){return l}});var a=r(7437),n=r(2265),s=r(1216);let l=n.forwardRef((e,t)=>{let{className:r,type:n,...l}=e;return(0,a.jsx)("input",{type:n,className:(0,s.cn)("flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...l})});l.displayName="Input"},6126:function(e,t,r){"use strict";r.d(t,{Bw:function(){return p},Ph:function(){return c},Ql:function(){return h},i4:function(){return f},ki:function(){return u}});var a=r(7437),n=r(2265),s=r(3402),l=r(875),i=r(2135),o=r(401),d=r(1216);let c=s.fC;s.ZA;let u=s.B4,f=n.forwardRef((e,t)=>{let{className:r,children:n,...i}=e;return(0,a.jsxs)(s.xz,{ref:t,className:(0,d.cn)("flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...i,children:[n,(0,a.jsx)(s.JO,{asChild:!0,children:(0,a.jsx)(l.Z,{className:"h-4 w-4 opacity-50"})})]})});f.displayName=s.xz.displayName;let m=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.u_,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",r),...n,children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})})});m.displayName=s.u_.displayName;let x=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.$G,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",r),...n,children:(0,a.jsx)(l.Z,{className:"h-4 w-4"})})});x.displayName=s.$G.displayName;let p=n.forwardRef((e,t)=>{let{className:r,children:n,position:l="popper",...i}=e;return(0,a.jsx)(s.h_,{children:(0,a.jsxs)(s.VY,{ref:t,className:(0,d.cn)("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:l,...i,children:[(0,a.jsx)(m,{}),(0,a.jsx)(s.l_,{className:(0,d.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,a.jsx)(x,{})]})})});p.displayName=s.VY.displayName,n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.__,{ref:t,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...n})}).displayName=s.__.displayName;let h=n.forwardRef((e,t)=>{let{className:r,children:n,...l}=e;return(0,a.jsxs)(s.ck,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(s.wU,{children:(0,a.jsx)(o.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(s.eT,{children:n})]})});h.displayName=s.ck.displayName,n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.Z0,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",r),...n})}).displayName=s.Z0.displayName},5557:function(e,t,r){"use strict";r.d(t,{RM:function(){return o},SC:function(){return d},iA:function(){return l},pj:function(){return u},ss:function(){return c},xD:function(){return i}});var a=r(7437),n=r(2265),s=r(1216);let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,s.cn)("w-full caption-bottom text-sm",r),...n})})});l.displayName="Table";let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("thead",{ref:t,className:(0,s.cn)("[&_tr]:border-b",r),...n})});i.displayName="TableHeader";let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,s.cn)("[&_tr:last-child]:border-0",r),...n})});o.displayName="TableBody",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,s.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...n})}).displayName="TableFooter";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("tr",{ref:t,className:(0,s.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...n})});d.displayName="TableRow";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("th",{ref:t,className:(0,s.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...n})});c.displayName="TableHead";let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("td",{ref:t,className:(0,s.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...n})});u.displayName="TableCell",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("caption",{ref:t,className:(0,s.cn)("mt-4 text-sm text-muted-foreground",r),...n})}).displayName="TableCaption"},3340:function(e,t,r){"use strict";r.d(t,{H:function(){return i},a:function(){return o}});var a=r(7437),n=r(2265),s=r(3196);let l=(0,n.createContext)(void 0);function i(e){let{children:t}=e,[r,i]=(0,n.useState)(null),[o,d]=(0,n.useState)(!0),[c,u]=(0,n.useState)(null),[f,m]=(0,n.useState)([]),x=(0,n.useCallback)(async()=>{try{let r=await fetch("/api/auth/me",{credentials:"include"});if(r.ok){var e,t;let a=await r.json();if(i(a.user),m(a.sites||[]),(null===(e=a.sites)||void 0===e?void 0:e.length)===1)u(a.sites[0]);else{let e=localStorage.getItem("currentSiteId");if(e){let r=null===(t=a.sites)||void 0===t?void 0:t.find(t=>t.id===e);r&&u(r)}}}else i(null),m([]),u(null)}catch(e){i(null)}finally{d(!1)}},[]);(0,n.useEffect)(()=>{x()},[x]);let p=async(e,t)=>{var r;let a=await (0,s.Nv)("POST","/api/auth/login",{email:e,password:t}),n=await a.json();i(n.user),m(n.sites||[]),(null===(r=n.sites)||void 0===r?void 0:r.length)===1&&u(n.sites[0])},h=async()=>{await (0,s.Nv)("POST","/api/auth/logout"),i(null),u(null),m([]),localStorage.removeItem("currentSiteId")};return(0,a.jsx)(l.Provider,{value:{user:r,isLoading:o,isAuthenticated:!!r,currentSite:c,availableSites:f,login:p,logout:h,selectSite:e=>{u(e),localStorage.setItem("currentSiteId",e.id)},refreshUser:x},children:t})}function o(){let e=(0,n.useContext)(l);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},3196:function(e,t,r){"use strict";async function a(e){if(!e.ok){let t=await e.text()||e.statusText;throw Error("".concat(e.status,": ").concat(t))}}async function n(e,t,r){let n=await fetch(t,{method:e,headers:r?{"Content-Type":"application/json"}:{},body:r?JSON.stringify(r):void 0,credentials:"include"});return await a(n),n}r.d(t,{Eh:function(){return s},Nv:function(){return n}});let s=new(r(946)).S({defaultOptions:{queries:{queryFn:(e=>{let{on401:t}=e;return async e=>{let{queryKey:r}=e,n=await fetch(r.join("/"),{credentials:"include"});return"returnNull"===t&&401===n.status?null:(await a(n),await n.json())}})({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}})},1216:function(e,t,r){"use strict";r.d(t,{cn:function(){return s}});var a=r(1994),n=r(3335);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,a.W)(t))}},9376:function(e,t,r){"use strict";var a=r(5475);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}})}},function(e){e.O(0,[454,946,720,661,306,648,16,763,971,117,744],function(){return e(e.s=9375)}),_N_E=e.O()}]);